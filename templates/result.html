{% extends "template.html" %} {% block title %}Result{% endblock %} {% block content %}
<div class=" div-margin-top-5">
    {% if PWM %}
    <div class="row div-center-90">
        <!--For button which allows you to change view of different result-->
        {% for result in result_package %}
        <button type="button" class="btn btn-secondary" id="btn_{{result[0]}}" onclick="javascript:changeView('{{result[0]}}')">{{result[0]}}
            </button> {% endfor %}
    </div>
    <div class="row" style=" width: 70%;text-align:initial;margin:0 auto;">
        <!--result[0] for result_set id,rsult[1] for result set-->
        {% for result in result_package %}
        <div class="row" id="table_{{result[0]}}" style="width:99%;margin:0 auto;text-align:initial;display:none;">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Domain</th>
                        <th>Peptide</th>
                        <th>Start</th>
                        <th>Stop</th>
                        <th>Sequence</th>
                        <th>Peptide Score</th>
                        <th>Peptide Count</th>
                        <th>Protein Score</th>
                        <th>Protein Count</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody>
                    {% for data in result[1] %}
                    <tr>
                        <th scope="row">1</th>
                        {% for x in data %}
                        <td>{{x}}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="row" style=" width: 70%;text-align:initial;margin:0 auto;">
        <div class="row" id="table_result" style="width:99%;margin:0 auto;text-align:initial;">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Interaction Proteins </th>
                        <th>Features Used For Predicting</th>
                        <th>Probability of Interaction</th>
                    </tr>
                </thead>
                <tbody>
                    {% for data in result_package %}
                    <tr>
                        <th scope="row">1</th>
                        {% for x in data %}
                        <td>{{x}}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
    <div class="row div-center-90">
        <a type="button" class="btn btn-info" href="/download/{{SESSIONID}}">Download</a>
        <button id="btn_permalink" type="button" class="btn btn-info" data-copytarget="#result_page_url">Permalink</button>
        <input type="text" id="result_page_url" value="http://127.0.0.1:5000/result/{{SESSIONID}}" style="display:none;" />
    </div>
</div>
<script>
    function toggleDiv(divId) {
        $("#" + divId).toggle();
    }
    // when document ready , function below will be executed
    $(document).ready(function() {
        toggleDiv('index_placeholder');
        toggleDiv("table_0");
        document.getElementById("btn_0").classList.remove("btn-secondary");
        document.getElementById("btn_0").classList.add("btn-danger");
    });

    var current_view = "0"; //store current rersult view id
    //function below is used to change result view
    function changeView(id) {
        document.getElementById("btn_" + current_view).classList.add("btn-secondary");
        document.getElementById("btn_" + current_view).classList.remove("btn-danger");
        toggleDiv("table_" + current_view);
        toggleDiv("table_" + id);
        current_view = id;
        document.getElementById("btn_" + current_view).classList.remove("btn-secondary");
        document.getElementById("btn_" + current_view).classList.add("btn-danger");
    }

    // copy to clipboard function from https://www.sitepoint.com/javascript-copy-to-clipboard/
    (function() {
        'use strict';
        // click events
        document.body.addEventListener('click', copy, true);
        // event handler
        function copy(e) {
            // find target element
            var
                t = e.target,
                c = t.dataset.copytarget,
                inp = (c ? document.querySelector(c) : null);
            // is element selectable?
            if (inp && inp.select) {
                // select text
                inp.select();
                try {
                    // copy text
                    document.execCommand('copy');
                    inp.blur();
                    document.getElementById("btn_permalink").textContent = "COPIED";
                    setTimeout(function() {
                        document.getElementById("btn_permalink").textContent = "PERMALINK";
                    }, 3000);
                } catch (err) {
                    alert('cannot automatic copy to clipboard. Please copy URL from the address manually.');
                }
            }
        }
    })();
</script>
{% endblock %}